{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\polia\\\\Desktop\\\\Overlay\\\\src\\\\pages\\\\Mapbox.tsx\",\n    _s = $RefreshSig$();\n\n// @ts-nocheck\nimport { useRef, useEffect, useState, useCallback } from \"react\";\nimport mapboxgl from \"mapbox-gl\";\nimport \"mapbox-gl/dist/mapbox-gl.css\";\nimport ReactDOM from 'react-dom';\nimport { makeStyles, Box, IconButton } from '@material-ui/core';\nimport AddIcon from '@mui/icons-material/Add';\nimport RemoveIcon from '@mui/icons-material/Remove';\nimport clusterBlue from \"../assets/clusterBlue.svg\";\nimport unclusteredPoint from \"../assets/unclusteredPoint.svg\";\nimport \"../styles/App.css\";\nimport Legend from \"../components/Legend\";\nimport { mapboxStyle, states12MilesRadius, states12MilesSteps, states18MilesRadius, states18MilesSteps, states6MilesRadius, states6MilesSteps, statesHeatmapFill, statesHeatmapSteps, statesMapFilter, statesCircleStroke18, statesCircleStroke6, statesCircleStroke12, getPixels } from \"../helpers/Utils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(() => ({\n  chartDiv: {\n    height: '25em'\n  },\n  ctrlWrapper: {\n    zIndex: 1000,\n    position: 'absolute',\n    right: 0,\n    top: 0\n  }\n}));\nmapboxgl.accessToken = \"pk.eyJ1IjoiZW5nbWFwYm94IiwiYSI6ImNqY3M1ZXA5czM2ZGYzM283ZmhscDltcGMifQ.Za7ut_7UThGzvjWhX4ACJQ\";\nexport const Mapbox = _ref => {\n  _s();\n\n  let {\n    geoJson,\n    poi,\n    Popup\n  } = _ref;\n  const [colorScheme, setColorScheme] = useState([]);\n  const [steps, setSteps] = useState([]);\n  const [poiViews6Miles, setPoiViews6Miles] = useState([]);\n  const [poiColor6Miles, setPoiColor6Miles] = useState([]);\n  const [poiViews12Miles, setPoiViews12Miles] = useState([]);\n  const [poiColor12Miles, setPoiColor12Miles] = useState([]);\n  const [poiViews18Miles, setPoiViews18Miles] = useState([]);\n  const [poiColor18Miles, setPoiColor18Miles] = useState([]);\n  const mapContainer = useRef();\n  const map = useRef();\n  const popUpRef = useRef();\n  const geoCoder = useRef();\n  const classes = useStyles();\n  useEffect(() => {\n    setColorScheme(statesHeatmapFill);\n    setSteps(statesHeatmapSteps);\n    setPoiColor6Miles(states6MilesRadius);\n    setPoiViews6Miles(states6MilesSteps);\n    setPoiColor12Miles(states12MilesRadius);\n    setPoiViews12Miles(states12MilesSteps);\n    setPoiColor18Miles(states18MilesRadius);\n    setPoiViews18Miles(states18MilesSteps);\n  }, []);\n  useEffect(() => {\n    //initialize popup just once\n    popUpRef.current = new mapboxgl.Popup({\n      closeButton: false,\n      closeOnClick: false\n    });\n  }, []);\n  useEffect(() => {\n    map.current = new mapboxgl.Map({\n      container: mapContainer.current,\n      style: mapboxStyle,\n      center: [-97, 36],\n      zoom: 3.3\n    });\n    console.log(poi); // only want to work with the map after it has fully loaded\n    // if you try to add sources and layers before the map has loaded\n    // things will not work properly\n\n    map.current.on(\"load\", () => {\n      map.current.addSource(\"sites\", {\n        type: \"geojson\",\n        data: poi\n      });\n      map.current.addSource(\"states\", {\n        type: \"geojson\",\n        data: geoJson\n      });\n      map.current.addLayer({\n        id: \"hover\",\n        type: \"fill\",\n        source: \"states\",\n        paint: {\n          \"fill-color\": statesMapFilter,\n          \"fill-opacity\": 0.8,\n          \"fill-outline-color\": \"#000\"\n        }\n      });\n      map.current.addLayer({\n        id: \"unclustered-point-1\",\n        type: \"circle\",\n        source: \"sites\",\n        filter: [\"!\", [\"has\", \"point_count\"]],\n        paint: {\n          \"circle-opacity\": 0,\n          'circle-stroke-opacity': 0.5,\n          \"circle-radius\": [\"interpolate\", [\"linear\"], [\"zoom\"], // zoom is 5 (or less) -> circle radius will be 1px\n          5, 5, // zoom is 10 (or greater) -> circle radius will be 5px\n          6, 12, 7, 24, 8, 36],\n          \"circle-stroke-width\": [\"interpolate\", [\"linear\"], [\"zoom\"], // zoom is 5 (or less) -> circle radius will be 1px\n          5, 3 // zoom is 10 (or greater) -> circle radius will be 5px\n          ],\n          \"circle-stroke-color\": statesCircleStroke18\n        }\n      });\n      map.current.addLayer({\n        id: \"unclustered-point\",\n        type: \"circle\",\n        source: \"sites\",\n        filter: [\"!\", [\"has\", \"point_count\"]],\n        paint: {\n          \"circle-color\": statesCircleStroke6,\n          \"circle-radius\": [\"interpolate\", [\"linear\"], [\"zoom\"], // zoom is 5 (or less) -> circle radius will be 1px\n          5, 3 // zoom is 10 (or greater) -> circle radius will be 5px\n          ],\n          \"circle-stroke-width\": [\"interpolate\", [\"linear\"], [\"zoom\"], // zoom is 5 (or less) -> circle radius will be 1px\n          5, 1 // zoom is 10 (or greater) -> circle radius will be 5px\n          ],\n          \"circle-stroke-color\": statesCircleStroke12\n        }\n      });\n      map.current.on(\"click\", \"unclustered-point\", e => {\n        e.preventDefault();\n        let f = map.current.queryRenderedFeatures(e.point, {\n          layers: ['unclustered-point-1']\n        });\n\n        if (f.length) {\n          map.current.getCanvas().style.cursor = 'pointer';\n          let popupNode = document.createElement('div');\n\n          if (Popup) {\n            let elem = /*#__PURE__*/_jsxDEV(Popup, {\n              data: f[0]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 28\n            }, this);\n\n            ReactDOM.render(elem, popupNode);\n            popUpRef.current.setLngLat(e.lngLat).setDOMContent(popupNode).addTo(map.current);\n          }\n\n          return;\n        }\n      });\n      map.current.on('mouseover', `hover`, () => {\n        map.current.getCanvas().style.cursor = '';\n        popUpRef.current.remove();\n      });\n      map.current.on('click', e => {\n        if (e.defaultPrevented === false) {\n          popUpRef.current.remove();\n        }\n      });\n    }); // cleanup function to remove map on unmount\n\n    return () => map.current.remove();\n  }, [Popup, geoJson, poi, poiColor12Miles, poiColor6Miles, poiViews12Miles, poiViews6Miles]);\n  const createRadiusOnZoom = useCallback(currentZoom => {\n    let stops18 = [];\n    let stops12 = [];\n    let stops6 = [];\n    let highlight = {};\n    let innerRadius = {};\n    let pixels = 7;\n\n    if (map.current) {\n      pixels = getPixels(supportedCountry, Number(currentZoom), miles);\n    }\n\n    stops18.push(['Mock', pixels]);\n    stops12.push(['Mock', Number(pixels / 2)]);\n    stops6.push([product.productId, Number(pixels / 4)]);\n    highlight = {\n      property: 'vendor',\n      type: 'categorical',\n      stops: stops18\n    };\n    innerRadius = {\n      property: 'vendor',\n      type: 'categorical',\n      stops: stops6\n    };\n    midRadius = {\n      property: 'vendor',\n      type: 'categorical',\n      stops: stops12\n    };\n    return {\n      highlight: highlight,\n      innerRadius: innerRadius,\n      midRadius: midRadius\n    };\n  }, []);\n  const zoomIn = useCallback(() => {\n    if (map.current !== undefined) {\n      let currentZoom = map.current.getZoom();\n\n      if (currentZoom) {\n        map.current.zoomTo(Number(currentZoom) + 0.7, {\n          duration: 350\n        });\n        let radius = createRadiusOnZoom(currentZoom);\n\n        if (map.current !== undefined && map.current.isStyleLoaded()) {\n          map.current.setPaintProperty('unclustered-point-1', 'circle-radius', radius.highlight);\n          map.current.setPaintProperty('unclustered-point', 'circle-radius', radius.innerRadius);\n          map.current.setPaintProperty('unclustered-point', 'circle-stroke-width', radius.midRadius);\n        }\n      }\n    }\n  }, [createRadiusOnZoom]);\n  const zoomOut = useCallback(() => {\n    if (map.current !== undefined) {\n      let currentZoom = map.current.getZoom();\n\n      if (currentZoom) {\n        map.current.zoomTo(Number(currentZoom) - 0.7, {\n          duration: 350\n        });\n        let radius = createRadiusOnZoom(currentZoom);\n\n        if (map.current !== undefined && map.current.isStyleLoaded()) {\n          map.current.setPaintProperty('unclustered-point-1', 'circle-radius', radius.highlight);\n          map.current.setPaintProperty('unclustered-point', 'circle-radius', radius.innerRadius);\n          map.current.setPaintProperty('unclustered-point', 'circle-stroke-width', radius.midRadius);\n        }\n      }\n    }\n  }, [createRadiusOnZoom]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Legend, {\n      type: \"dots\",\n      clusters: \"Clusters\",\n      pointCount: \"Views\",\n      clusterImg: clusterBlue,\n      unclusteredImg: unclusteredPoint,\n      unclusteredPoint: \"Unclustered Points\",\n      colorScheme: colorScheme,\n      steps: steps,\n      poi: \"POI\",\n      views: \"Views\",\n      poiColor6Miles: poiColor6Miles,\n      poiViews6Miles: poiViews6Miles,\n      poiColor12Miles: poiColor12Miles,\n      poiViews12Miles: poiViews12Miles,\n      poiColor18Miles: poiColor18Miles,\n      poiViews18Miles: poiViews18Miles\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapContainer,\n      style: {\n        width: \"100%\",\n        height: \"100vh\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.ctrlWrapper,\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        children: [/*#__PURE__*/_jsxDEV(IconButton, {\n          \"aria-label\": \"zoom in\",\n          children: /*#__PURE__*/_jsxDEV(AddIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n          \"aria-label\": \"zoom out\",\n          children: /*#__PURE__*/_jsxDEV(RemoveIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Mapbox, \"2V6G7dJiN9ntudwJfg1xHd9kdfo=\", false, function () {\n  return [useStyles];\n});\n\n_c = Mapbox;\n\nvar _c;\n\n$RefreshReg$(_c, \"Mapbox\");","map":{"version":3,"sources":["C:/Users/polia/Desktop/Overlay/src/pages/Mapbox.tsx"],"names":["useRef","useEffect","useState","useCallback","mapboxgl","ReactDOM","makeStyles","Box","IconButton","AddIcon","RemoveIcon","Legend","mapboxStyle","states12MilesRadius","states12MilesSteps","states18MilesRadius","states18MilesSteps","states6MilesRadius","states6MilesSteps","statesHeatmapFill","statesHeatmapSteps","statesMapFilter","statesCircleStroke18","statesCircleStroke6","statesCircleStroke12","getPixels","useStyles","chartDiv","height","ctrlWrapper","zIndex","position","right","top","accessToken","Mapbox","geoJson","poi","Popup","colorScheme","setColorScheme","steps","setSteps","poiViews6Miles","setPoiViews6Miles","poiColor6Miles","setPoiColor6Miles","poiViews12Miles","setPoiViews12Miles","poiColor12Miles","setPoiColor12Miles","poiViews18Miles","setPoiViews18Miles","poiColor18Miles","setPoiColor18Miles","mapContainer","map","popUpRef","geoCoder","classes","current","closeButton","closeOnClick","Map","container","style","center","zoom","console","log","on","addSource","type","data","addLayer","id","source","paint","filter","e","preventDefault","f","queryRenderedFeatures","point","layers","length","getCanvas","cursor","popupNode","document","createElement","elem","render","setLngLat","lngLat","setDOMContent","addTo","remove","defaultPrevented","createRadiusOnZoom","currentZoom","stops18","stops12","stops6","highlight","innerRadius","pixels","supportedCountry","Number","miles","push","product","productId","property","stops","midRadius","zoomIn","undefined","getZoom","zoomTo","duration","radius","isStyleLoaded","setPaintProperty","zoomOut","clusterBlue","unclusteredPoint","width"],"mappings":"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","sourcesContent":["// @ts-nocheck\nimport { useRef, useEffect, useState, useCallback } from \"react\"\nimport mapboxgl from \"mapbox-gl\"\nimport \"mapbox-gl/dist/mapbox-gl.css\"\nimport MapboxGeocoder from '@mapbox/mapbox-gl-geocoder'\nimport ReactDOM from 'react-dom'\nimport { makeStyles, Box, IconButton } from '@material-ui/core'\nimport AddIcon from '@mui/icons-material/Add'\nimport RemoveIcon from '@mui/icons-material/Remove';\nimport clusterBlue from \"../assets/clusterBlue.svg\"\nimport unclusteredPoint from \"../assets/unclusteredPoint.svg\"\nimport \"../styles/App.css\"\nimport Legend from \"../components/Legend\"\nimport { mapboxStyle, states12MilesRadius, states12MilesSteps, states18MilesRadius, states18MilesSteps, states6MilesRadius, states6MilesSteps, statesHeatmapFill, statesHeatmapSteps, statesMapFilter, statesCircleStroke18, statesCircleStroke6, statesCircleStroke12, getPixels } from \"../helpers/Utils\"\n\n\nconst useStyles = makeStyles(() => ({\n  chartDiv: {\n    height: '25em'\n  },\n  ctrlWrapper: {\n    zIndex: 1000,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n  }\n}))\n\nmapboxgl.accessToken =\n  \"pk.eyJ1IjoiZW5nbWFwYm94IiwiYSI6ImNqY3M1ZXA5czM2ZGYzM283ZmhscDltcGMifQ.Za7ut_7UThGzvjWhX4ACJQ\";\n\n\nexport const Mapbox = ({ geoJson, poi, Popup }) => {\n  const [colorScheme, setColorScheme] = useState<Array<string>>([])\n  const [steps, setSteps] = useState<Array<number>>([])\n\n  const [poiViews6Miles, setPoiViews6Miles] = useState<Array<number>>([])\n  const [poiColor6Miles, setPoiColor6Miles] = useState<Array<string>>([])\n\n  const [poiViews12Miles, setPoiViews12Miles] = useState<Array<number>>([])\n  const [poiColor12Miles, setPoiColor12Miles] = useState<Array<string>>([])\n\n  const [poiViews18Miles, setPoiViews18Miles] = useState<Array<number>>([])\n  const [poiColor18Miles, setPoiColor18Miles] = useState<Array<string>>([])\n\n  const mapContainer = useRef()\n  const map = useRef()\n  const popUpRef = useRef()\n  const geoCoder = useRef()\n\n\n  const classes = useStyles()\n\n\n  useEffect(() => {\n    setColorScheme(statesHeatmapFill)\n    setSteps(statesHeatmapSteps)\n\n    setPoiColor6Miles(states6MilesRadius)\n\n    setPoiViews6Miles(states6MilesSteps)\n\n    setPoiColor12Miles(states12MilesRadius)\n    setPoiViews12Miles(states12MilesSteps)\n\n    setPoiColor18Miles(states18MilesRadius)\n    setPoiViews18Miles(states18MilesSteps)\n  }, [])\n\n  useEffect(() => {\n    //initialize popup just once\n    popUpRef.current = new mapboxgl.Popup({\n        closeButton: false,\n        closeOnClick: false,\n    })\n}, [])\n\n\n  useEffect(() => {\n    map.current = new mapboxgl.Map({\n      container: mapContainer.current,\n      style: mapboxStyle,\n      center: [-97, 36],\n      zoom: 3.3,\n    })\n\n    console.log(poi)\n\n    // only want to work with the map after it has fully loaded\n    // if you try to add sources and layers before the map has loaded\n    // things will not work properly\n    map.current.on(\"load\", () => {\n      map.current.addSource(\"sites\", {\n        type: \"geojson\",\n        data: poi,\n      })\n\n      map.current.addSource(\"states\", {\n        type: \"geojson\",\n        data: geoJson,\n      })\n\n      map.current.addLayer({\n        id: \"hover\",\n        type: \"fill\",\n        source: \"states\",\n        paint: {\n          \"fill-color\": statesMapFilter,\n          \"fill-opacity\": 0.8,\n          \"fill-outline-color\": \"#000\",\n        },\n        \n      })\n\n\n      map.current.addLayer({\n        id: \"unclustered-point-1\",\n        type: \"circle\",\n        source: \"sites\",\n        filter: [\"!\", [\"has\", \"point_count\"]],\n        paint: {\n          \"circle-opacity\": 0,\n          'circle-stroke-opacity': 0.5,\n          \"circle-radius\": [\n            \"interpolate\",\n            [\"linear\"],\n            [\"zoom\"],\n\n            // zoom is 5 (or less) -> circle radius will be 1px\n            5,\n            5,\n            // zoom is 10 (or greater) -> circle radius will be 5px\n            6,\n            12,\n\n            7,\n            24,\n\n            8,\n            36\n          ],\n          \"circle-stroke-width\": [\n            \"interpolate\",\n            [\"linear\"],\n            [\"zoom\"],\n            // zoom is 5 (or less) -> circle radius will be 1px\n            5,\n            3,\n            // zoom is 10 (or greater) -> circle radius will be 5px\n          ],\n          \"circle-stroke-color\": statesCircleStroke18,\n        },\n      })\n      map.current.addLayer({\n        id: \"unclustered-point\",\n        type: \"circle\",\n        source: \"sites\",\n        filter: [\"!\", [\"has\", \"point_count\"]],\n        paint: {\n          \"circle-color\": statesCircleStroke6,\n          \"circle-radius\": [\n            \"interpolate\",\n            [\"linear\"],\n            [\"zoom\"],\n            // zoom is 5 (or less) -> circle radius will be 1px\n            5,\n            3,\n            // zoom is 10 (or greater) -> circle radius will be 5px\n          ],\n          \"circle-stroke-width\": [\n            \"interpolate\",\n            [\"linear\"],\n            [\"zoom\"],\n            // zoom is 5 (or less) -> circle radius will be 1px\n            5,\n            1,\n            // zoom is 10 (or greater) -> circle radius will be 5px\n          ],\n          \"circle-stroke-color\": statesCircleStroke12,\n        },\n      })\n\n      map.current.on(\"click\", \"unclustered-point\", (e: any) => {\n        e.preventDefault()\n        let f = map.current.queryRenderedFeatures(e.point, { layers: ['unclustered-point-1'] })\n\n        if (f.length) {\n            map.current.getCanvas().style.cursor = 'pointer'\n            let popupNode = document.createElement('div')\n            if (Popup) {\n                let elem = <Popup data={f[0]} />\n                ReactDOM.render(elem, popupNode)\n                popUpRef.current\n                    .setLngLat(e.lngLat)\n                    .setDOMContent(popupNode)\n                    .addTo(map.current)\n            }\n            return\n        }\n      })\n\n        map.current.on('mouseover', `hover`, () => {\n        map.current.getCanvas().style.cursor = ''\n        popUpRef.current.remove()\n      }) \n      \n\n      map.current.on('click', (e) => {\n        if (e.defaultPrevented === false) {\n          popUpRef.current.remove()\n        }\n      });\n      \n     \n    })\n\n    // cleanup function to remove map on unmount\n    return () => map.current.remove()\n  }, [Popup, geoJson, poi, poiColor12Miles, poiColor6Miles, poiViews12Miles, poiViews6Miles])\n\n\n  const createRadiusOnZoom = useCallback((currentZoom: number) => {\n    let stops18: any = []\n    let stops12: any = []\n    let stops6: any = []\n    let highlight = {}\n    let innerRadius = {}\n    let pixels: number = 7\n\n    if (map.current) {\n        pixels = getPixels(supportedCountry!, Number(currentZoom), miles)\n    }\n\n    stops18.push(['Mock', pixels])\n    stops12.push(['Mock', Number(pixels / 2)])\n    stops6.push([product.productId, Number(pixels / 4)])\n    highlight = {\n        property: 'vendor',\n        type: 'categorical',\n        stops: stops18,\n    }\n    innerRadius = {\n        property: 'vendor',\n        type: 'categorical',\n        stops: stops6,\n    }\n\n    midRadius = {\n      property: 'vendor',\n        type: 'categorical',\n        stops: stops12,\n    }\n\n    return {\n        highlight: highlight,\n        innerRadius: innerRadius,\n        midRadius: midRadius\n    }\n}, [])\n\n\nconst zoomIn = useCallback(() => {\n  if (map.current !== undefined) {\n      let currentZoom = map.current.getZoom()\n\n      if (currentZoom) {\n          map.current.zoomTo(Number(currentZoom) + 0.7, {\n              duration: 350,\n          })\n\n          let radius = createRadiusOnZoom(currentZoom)\n\n          if (map.current !== undefined && map.current.isStyleLoaded()) {\n            map.current.setPaintProperty('unclustered-point-1', 'circle-radius', radius.highlight)\n            map.current.setPaintProperty('unclustered-point', 'circle-radius', radius.innerRadius)\n            map.current.setPaintProperty('unclustered-point', 'circle-stroke-width', radius.midRadius)\n        }\n      }\n  }\n}, [createRadiusOnZoom])\n\n\nconst zoomOut = useCallback(() => {\n  if (map.current !== undefined) {\n      let currentZoom = map.current.getZoom()\n\n      if (currentZoom) {\n          map.current.zoomTo(Number(currentZoom) - 0.7, {\n              duration: 350,\n          })\n\n          let radius = createRadiusOnZoom(currentZoom)\n\n          if (map.current !== undefined && map.current.isStyleLoaded()) {\n            map.current.setPaintProperty('unclustered-point-1', 'circle-radius', radius.highlight)\n            map.current.setPaintProperty('unclustered-point', 'circle-radius', radius.innerRadius)\n            map.current.setPaintProperty('unclustered-point', 'circle-stroke-width', radius.midRadius)\n        }\n      }\n  }\n}, [createRadiusOnZoom])\n\n\n  return (\n    <>\n      <Legend\n        type=\"dots\"\n        clusters=\"Clusters\"\n        pointCount=\"Views\"\n        clusterImg={clusterBlue}\n        unclusteredImg={unclusteredPoint}\n        unclusteredPoint=\"Unclustered Points\"\n        colorScheme={colorScheme}\n        steps={steps}\n        poi=\"POI\"\n        views=\"Views\"\n        poiColor6Miles={poiColor6Miles}\n        poiViews6Miles={poiViews6Miles}\n        poiColor12Miles={poiColor12Miles}\n        poiViews12Miles={poiViews12Miles}\n        poiColor18Miles={poiColor18Miles}\n        poiViews18Miles={poiViews18Miles}\n      />\n      <div ref={mapContainer} style={{ width: \"100%\", height: \"100vh\" }} />\n      <div className={classes.ctrlWrapper}>\n        <Box>\n          <IconButton aria-label=\"zoom in\">\n            <AddIcon />\n          </IconButton>\n          <IconButton aria-label=\"zoom out\">\n            <RemoveIcon /> \n          </IconButton>\n        </Box>\n      </div>\n    </>\n  )\n}\n\n\n"]},"metadata":{},"sourceType":"module"}