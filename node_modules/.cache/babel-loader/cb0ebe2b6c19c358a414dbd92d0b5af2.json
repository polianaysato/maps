{"ast":null,"code":"/**\r\n * Module that defines everything related to building Funnel slices.\r\n */\nimport { __extends } from \"tslib\";\n/**\r\n * ============================================================================\r\n * IMPORTS\r\n * ============================================================================\r\n * @hidden\r\n */\n\nimport { Container } from \"../../core/Container\";\nimport { Sprite } from \"../../core/Sprite\";\nimport { registry } from \"../../core/Registry\";\nimport { percent } from \"../../core/utils/Percent\";\nimport * as $utils from \"../../core/utils/Utils\";\nimport * as $path from \"../../core/rendering/Path\";\n/**\r\n * ============================================================================\r\n * MAIN CLASS\r\n * ============================================================================\r\n * @hidden\r\n */\n\n/**\r\n * Class used to create [[FunnelSlice]] elements.\r\n *\r\n * @see {@link IFunnelSliceEvents} for a list of available events\r\n * @see {@link IFunnelSliceAdapters} for a list of available adapters\r\n * @see {@link https://www.amcharts.com/docs/v4/chart-types/sliced-chart/} for documentation\r\n * @important\r\n */\n\nvar FunnelSlice =\n/** @class */\nfunction (_super) {\n  __extends(FunnelSlice, _super);\n  /**\r\n   * Constructor\r\n   */\n\n\n  function FunnelSlice() {\n    var _this = _super.call(this) || this;\n\n    _this.slice = _this.createChild(Sprite);\n    _this.slice.shouldClone = false;\n\n    _this.slice.setElement(_this.paper.add(\"path\"));\n\n    _this.slice.isMeasured = false;\n    _this.orientation = \"vertical\";\n    _this.bottomWidth = percent(100);\n    _this.topWidth = percent(100);\n    _this.isMeasured = false;\n    _this.width = 10;\n    _this.height = 10;\n    _this.expandDistance = 0;\n    _this.className = \"FunnelSlice\";\n\n    _this.applyTheme();\n\n    return _this;\n  }\n  /**\r\n   * Draws the element.\r\n   */\n\n\n  FunnelSlice.prototype.draw = function () {\n    _super.prototype.draw.call(this);\n\n    var pt = this.pixelPaddingTop;\n    var pb = this.pixelPaddingBottom;\n    var pr = this.pixelPaddingRight;\n    var pl = this.pixelPaddingLeft;\n    var w = this.pixelWidth - pr - pl;\n    var h = this.pixelHeight - pt - pb;\n    var ed = this.expandDistance;\n    var path = \"\";\n\n    if (this.orientation == \"vertical\") {\n      var tw = $utils.relativeToValue(this.topWidth, w);\n      var bw = $utils.relativeToValue(this.bottomWidth, w);\n      var tl = {\n        x: (w - tw) / 2 + pl,\n        y: pt\n      };\n      var tr = {\n        x: (w + tw) / 2 + pl,\n        y: pt\n      };\n      var br = {\n        x: (w + bw) / 2 + pl,\n        y: pt + h\n      };\n      var bl = {\n        x: (w - bw) / 2 + pl,\n        y: pt + h\n      };\n      var cpr = {\n        x: tr.x + (br.x - tr.x) / 2 + ed * h,\n        y: tr.y + 0.5 * h\n      };\n      var cpl = {\n        x: tl.x + (bl.x - tl.x) / 2 - ed * h,\n        y: tl.y + 0.5 * h\n      };\n      var qp1 = $path.lineTo(br);\n      var qp2 = $path.lineTo(tl);\n\n      if (ed != 0) {\n        qp1 = $path.quadraticCurveTo(br, cpr);\n        qp2 = $path.quadraticCurveTo(tl, cpl);\n      }\n\n      path = $path.moveTo(tl) + $path.lineTo(tr) + qp1 + $path.lineTo(bl) + qp2;\n      this.tickPoint = {\n        x: tr.x + (br.x - tr.x) / 2,\n        y: tr.y + (br.y - tr.y) / 2\n      };\n    } else {\n      var tw = $utils.relativeToValue(this.topWidth, h);\n      var bw = $utils.relativeToValue(this.bottomWidth, h);\n      var tt = {\n        x: pl,\n        y: (h - tw) / 2 + pt\n      };\n      var tb = {\n        x: pl,\n        y: (h + tw) / 2 + pt\n      };\n      var bt = {\n        x: pl + w,\n        y: (h - bw) / 2 + pt\n      };\n      var bb = {\n        x: pl + w,\n        y: (h + bw) / 2 + pt\n      };\n      var cpr = {\n        y: tt.y + (bt.y - tt.y) / 2 - ed * w,\n        x: tt.x + 0.5 * w\n      };\n      var cpl = {\n        y: tb.y + (bb.y - tb.y) / 2 + ed * w,\n        x: tb.x + 0.5 * w\n      };\n      var qp1 = $path.lineTo(bt);\n      var qp2 = $path.lineTo(tb);\n\n      if (ed != 0) {\n        qp1 = $path.quadraticCurveTo(bt, cpr);\n        qp2 = $path.quadraticCurveTo(tb, cpl);\n      }\n\n      path = $path.moveTo(tb) + $path.lineTo(tt) + qp1 + $path.lineTo(bb) + qp2;\n      this.tickPoint = {\n        y: tb.y + (bb.y - tb.y) / 2,\n        x: tb.x + (bb.x - tb.x) / 2\n      };\n    }\n\n    this.slice.path = path;\n    this.invalidateLayout();\n  };\n\n  FunnelSlice.prototype.getPoint = function (locationX, locationY) {\n    var pt = this.pixelPaddingTop;\n    var pb = this.pixelPaddingBottom;\n    var pr = this.pixelPaddingRight;\n    var pl = this.pixelPaddingLeft;\n    var w = this.pixelWidth - pr - pl;\n    var h = this.pixelHeight - pt - pb;\n\n    if (this.orientation == \"vertical\") {\n      var tw = $utils.relativeToValue(this.topWidth, w);\n      var bw = $utils.relativeToValue(this.bottomWidth, w);\n      var tl = {\n        x: (w - tw) / 2 + pl,\n        y: pt\n      };\n      var tr = {\n        x: (w + tw) / 2 + pl,\n        y: pt\n      };\n      var br = {\n        x: (w + bw) / 2 + pl,\n        y: pt + h\n      };\n      var bl = {\n        x: (w - bw) / 2 + pl,\n        y: pt + h\n      };\n      var mlx = tl.x + (bl.x - tl.x) * locationY;\n      var mrx = tr.x + (br.x - tr.x) * locationY;\n      return {\n        x: mlx + (mrx - mlx) * locationX,\n        y: tr.y + (br.y - tr.y) * locationY\n      };\n    } else {\n      var tw = $utils.relativeToValue(this.topWidth, h);\n      var bw = $utils.relativeToValue(this.bottomWidth, h);\n      var tt = {\n        x: pl,\n        y: (h - tw) / 2 + pt\n      };\n      var tb = {\n        x: pl,\n        y: (h + tw) / 2 + pt\n      };\n      var bt = {\n        x: pl + w,\n        y: (h - bw) / 2 + pt\n      };\n      var bb = {\n        x: pl + w,\n        y: (h + bw) / 2 + pt\n      };\n      var mty = tt.y + (bt.y - tt.y) * locationX;\n      var mby = tb.y + (bb.y - tb.y) * locationX;\n      return {\n        y: mty + (mby - mty) * locationY,\n        x: tt.x + (bt.x - tt.x) * locationX\n      };\n    }\n  };\n\n  Object.defineProperty(FunnelSlice.prototype, \"bottomWidth\", {\n    /**\r\n     * @return bottom width\r\n     */\n    get: function get() {\n      return this.getPropertyValue(\"bottomWidth\");\n    },\n\n    /**\r\n     * Bottom width in pixels or percent.\r\n     *\r\n     * IMPORTANT: this setting might be used to set dimensions if you use slice\r\n     * as a standalone element. If it's a part of [[FunnelSeries]] this setting\r\n     * becomes read-only as it will be automatically reset by series.\r\n     *\r\n     * @param value  Bottom width\r\n     */\n    set: function set(value) {\n      this.setPercentProperty(\"bottomWidth\", value, true, false, 10, false);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(FunnelSlice.prototype, \"topWidth\", {\n    /**\r\n     * @return Top width\r\n     */\n    get: function get() {\n      return this.getPropertyValue(\"topWidth\");\n    },\n\n    /**\r\n     * Top width in pixels or percent.\r\n     *\r\n     * IMPORTANT: this setting might be used to set dimensions if you use slice\r\n     * as a standalone element. If it's a part of [[FunnelSeries]] this setting\r\n     * becomes read-only as it will be automatically reset by series.\r\n     *\r\n     * @param value  Top width\r\n     */\n    set: function set(value) {\n      this.setPercentProperty(\"topWidth\", value, true, false, 10, false);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(FunnelSlice.prototype, \"orientation\", {\n    /**\r\n     * @return Orientation\r\n     */\n    get: function get() {\n      return this.getPropertyValue(\"orientation\");\n    },\n\n    /**\r\n     * Orientation of the funnel slice: \"horizontal\" or \"vertical\".\r\n     *\r\n     * IMPORTANT: this setting might be used to set orintation if you use slice\r\n     * as a standalone element. If it's a part of [[FunnelSeries]] this setting\r\n     * becomes read-only as it will be automatically reset by series.\r\n     *\r\n     * @param value  Orientation\r\n     */\n    set: function set(value) {\n      this.setPropertyValue(\"orientation\", value, true);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(FunnelSlice.prototype, \"expandDistance\", {\n    /**\r\n     * @return expandDistance\r\n     */\n    get: function get() {\n      return this.getPropertyValue(\"expandDistance\");\n    },\n\n    /**\r\n     * A relative distance slice's sides should be bent to. It's relative to the\r\n     * height of the slice.\r\n     *\r\n     * Zero (default) will mean the sides will be perfectly straight.\r\n     *\r\n     * Positive value will make them bend outwards, resulting in \"puffed\" slices.\r\n     *\r\n     * Negative values will make them bend inwards.\r\n     *\r\n     * @default 0\r\n     * @param {number}\r\n     */\n    set: function set(value) {\n      this.setPropertyValue(\"expandDistance\", value, true);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Copies all parameters from another [[Sprite]].\r\n   *\r\n   * @param source Source Sprite\r\n   */\n\n  FunnelSlice.prototype.copyFrom = function (source) {\n    _super.prototype.copyFrom.call(this, source);\n\n    if (this.slice) {\n      this.slice.copyFrom(source.slice);\n    }\n  };\n\n  return FunnelSlice;\n}(Container);\n\nexport { FunnelSlice };\n/**\r\n * Register class in system, so that it can be instantiated using its name from\r\n * anywhere.\r\n *\r\n * @ignore\r\n */\n\nregistry.registeredClasses[\"FunnelSlice\"] = FunnelSlice;","map":{"version":3,"mappings":"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","names":["Container","Sprite","registry","percent","$utils","$path","__extends","_super","_this","slice","createChild","shouldClone","setElement","paper","add","isMeasured","orientation","bottomWidth","topWidth","width","height","expandDistance","className","applyTheme","FunnelSlice","draw","call","pt","pixelPaddingTop","pb","pixelPaddingBottom","pr","pixelPaddingRight","pl","pixelPaddingLeft","w","pixelWidth","h","pixelHeight","ed","path","tw","relativeToValue","bw","tl","x","y","tr","br","bl","cpr","cpl","qp1","lineTo","qp2","quadraticCurveTo","moveTo","tickPoint","tt","tb","bt","bb","invalidateLayout","locationX","locationY","mlx","mrx","mty","mby","Object","getPropertyValue","value","setPercentProperty","setPropertyValue","source","copyFrom","registeredClasses"],"sourceRoot":"","sources":["../../../../../src/.internal/charts/elements/FunnelSlice.ts"],"sourcesContent":["/**\r\n * Module that defines everything related to building Funnel slices.\r\n */\r\n\r\n/**\r\n * ============================================================================\r\n * IMPORTS\r\n * ============================================================================\r\n * @hidden\r\n */\r\nimport { Container, IContainerProperties, IContainerAdapters, IContainerEvents } from \"../../core/Container\";\r\nimport { Sprite } from \"../../core/Sprite\";\r\nimport { registry } from \"../../core/Registry\";\r\nimport { percent, Percent } from \"../../core/utils/Percent\";\r\nimport * as $utils from \"../../core/utils/Utils\";\r\nimport { Orientation } from \"../../core/defs/Orientation\";\r\nimport { IPoint } from \"../../core/defs/IPoint\";\r\nimport * as $path from \"../../core/rendering/Path\";\r\n\r\n\r\n/**\r\n * ============================================================================\r\n * REQUISITES\r\n * ============================================================================\r\n * @hidden\r\n */\r\n\r\n/**\r\n * Defines properties for [[FunnelSlice]].\r\n */\r\nexport interface IFunnelSliceProperties extends IContainerProperties {\r\n\r\n\t/**\r\n\t * Width of the top edge of the slice.\r\n\t */\r\n\ttopWidth?: number | Percent;\r\n\r\n\t/**\r\n\t * Width of the bottom edge of the slice.\r\n\t */\r\n\tbottomWidth?: number | Percent;\r\n\r\n\t/**\r\n\t * A relative distance slice's sides should be bent to.\r\n\t *\r\n\t * @default 0\r\n\t */\r\n\texpandDistance?: number;\r\n\r\n\t/**\r\n\t * Orientation of the slice.\r\n\t */\r\n\torientation?: Orientation;\r\n}\r\n\r\n/**\r\n * Defines events for [[FunnelSlice]].\r\n */\r\nexport interface IFunnelSliceEvents extends IContainerEvents { }\r\n\r\n/**\r\n * Defines adapters for [[FunnelSlice]].\r\n *\r\n * @see {@link Adapter}\r\n */\r\nexport interface IFunnelSliceAdapters extends IContainerAdapters, IFunnelSliceProperties { }\r\n\r\n\r\n/**\r\n * ============================================================================\r\n * MAIN CLASS\r\n * ============================================================================\r\n * @hidden\r\n */\r\n\r\n/**\r\n * Class used to create [[FunnelSlice]] elements.\r\n *\r\n * @see {@link IFunnelSliceEvents} for a list of available events\r\n * @see {@link IFunnelSliceAdapters} for a list of available adapters\r\n * @see {@link https://www.amcharts.com/docs/v4/chart-types/sliced-chart/} for documentation\r\n * @important\r\n */\r\nexport class FunnelSlice extends Container {\r\n\r\n\t/**\r\n\t * Defines available properties.\r\n\t */\r\n\tpublic _properties!: IFunnelSliceProperties;\r\n\r\n\t/**\r\n\t * Defines available adapters.\r\n\t */\r\n\tpublic _adapter!: IFunnelSliceAdapters;\r\n\r\n\t/**\r\n\t * Defines available events.\r\n\t */\r\n\tpublic _events!: IFunnelSliceEvents;\r\n\r\n\t/**\r\n\t * Main slice element.\r\n\t */\r\n\tpublic slice: Sprite;\r\n\r\n\t/**\r\n\t * Am anchor point the slice tick line is pointing to.\r\n\t *\r\n\t * @ignore Exclude from docs\r\n\t * @readonly\r\n\t */\r\n\tpublic tickPoint: IPoint;\r\n\r\n\t/**\r\n\t * Constructor\r\n\t */\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.slice = this.createChild(Sprite);\r\n\t\tthis.slice.shouldClone = false;\r\n\t\tthis.slice.setElement(this.paper.add(\"path\"));\r\n\t\tthis.slice.isMeasured = false;\r\n\r\n\t\tthis.orientation = \"vertical\";\r\n\t\tthis.bottomWidth = percent(100);\r\n\t\tthis.topWidth = percent(100);\r\n\t\tthis.isMeasured = false;\r\n\r\n\t\tthis.width = 10;\r\n\t\tthis.height = 10;\r\n\r\n\t\tthis.expandDistance = 0;\r\n\r\n\t\tthis.className = \"FunnelSlice\";\r\n\r\n\t\tthis.applyTheme();\r\n\t}\r\n\r\n\t/**\r\n\t * Draws the element.\r\n\t */\r\n\tprotected draw(): void {\r\n\t\tsuper.draw();\r\n\r\n\t\tlet pt = this.pixelPaddingTop;\r\n\t\tlet pb = this.pixelPaddingBottom;\r\n\t\tlet pr = this.pixelPaddingRight;\r\n\t\tlet pl = this.pixelPaddingLeft;\r\n\r\n\t\tlet w = this.pixelWidth - pr - pl;\r\n\t\tlet h = this.pixelHeight - pt - pb;\r\n\r\n\t\tlet ed = this.expandDistance;\r\n\r\n\t\tlet path = \"\";\r\n\r\n\r\n\t\tif (this.orientation == \"vertical\") {\r\n\t\t\tlet tw = $utils.relativeToValue(this.topWidth, w);\r\n\t\t\tlet bw = $utils.relativeToValue(this.bottomWidth, w);\r\n\r\n\t\t\tlet tl = { x: (w - tw) / 2 + pl, y: pt };\r\n\t\t\tlet tr = { x: (w + tw) / 2 + pl, y: pt };\r\n\r\n\t\t\tlet br = { x: (w + bw) / 2 + pl, y: pt + h };\r\n\t\t\tlet bl = { x: (w - bw) / 2 + pl, y: pt + h };\r\n\r\n\t\t\tlet cpr = { x: tr.x + (br.x - tr.x) / 2 + ed * h, y: tr.y + 0.5 * h };\r\n\t\t\tlet cpl = { x: tl.x + (bl.x - tl.x) / 2 - ed * h, y: tl.y + 0.5 * h };\r\n\r\n\t\t\tlet qp1 = $path.lineTo(br);\r\n\t\t\tlet qp2 = $path.lineTo(tl);\r\n\r\n\t\t\tif(ed != 0){\r\n\t\t\t\tqp1 = $path.quadraticCurveTo(br, cpr);\r\n\t\t\t\tqp2 = $path.quadraticCurveTo(tl, cpl);\r\n\t\t\t}\r\n\r\n\t\t\tpath = $path.moveTo(tl) + $path.lineTo(tr) + qp1 + $path.lineTo(bl) + qp2;\r\n\r\n\t\t\tthis.tickPoint = { x: tr.x + (br.x - tr.x) / 2, y: tr.y + (br.y - tr.y) / 2 };\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet tw = $utils.relativeToValue(this.topWidth, h);\r\n\t\t\tlet bw = $utils.relativeToValue(this.bottomWidth, h);\r\n\r\n\t\t\tlet tt = { x: pl, y: (h - tw) / 2 + pt };\r\n\t\t\tlet tb = { x: pl, y: (h + tw) / 2 + pt };\r\n\r\n\t\t\tlet bt = { x: pl + w, y: (h - bw) / 2 + pt };\r\n\t\t\tlet bb = { x: pl + w, y: (h + bw) / 2 + pt };\r\n\r\n\t\t\tlet cpr = { y: tt.y + (bt.y - tt.y) / 2 - ed * w, x: tt.x + 0.5 * w };\r\n\t\t\tlet cpl = { y: tb.y + (bb.y - tb.y) / 2 + ed * w, x: tb.x + 0.5 * w };\r\n\r\n\t\t\tlet qp1 = $path.lineTo(bt);\r\n\t\t\tlet qp2 = $path.lineTo(tb);\r\n\t\t\tif(ed != 0){\r\n\t\t\t\tqp1 = $path.quadraticCurveTo(bt, cpr);\r\n\t\t\t\tqp2 = $path.quadraticCurveTo(tb, cpl);\r\n\t\t\t}\r\n\r\n\t\t\tpath = $path.moveTo(tb) + $path.lineTo(tt) + qp1 + $path.lineTo(bb) + qp2;\r\n\r\n\t\t\tthis.tickPoint = { y: tb.y + (bb.y - tb.y) / 2, x: tb.x + (bb.x - tb.x) / 2 };\r\n\t\t}\r\n\r\n\t\tthis.slice.path = path;\r\n\t\tthis.invalidateLayout();\r\n\t}\r\n\r\n\r\n\tgetPoint(locationX:number, locationY:number):IPoint{\r\n\r\n\t\tlet pt = this.pixelPaddingTop;\r\n\t\tlet pb = this.pixelPaddingBottom;\r\n\t\tlet pr = this.pixelPaddingRight;\r\n\t\tlet pl = this.pixelPaddingLeft;\r\n\r\n\t\tlet w = this.pixelWidth - pr - pl;\r\n\t\tlet h = this.pixelHeight - pt - pb;\r\n\r\n\t\tif (this.orientation == \"vertical\") {\r\n\t\t\tlet tw = $utils.relativeToValue(this.topWidth, w);\r\n\t\t\tlet bw = $utils.relativeToValue(this.bottomWidth, w);\r\n\r\n\t\t\tlet tl = { x: (w - tw) / 2 + pl, y: pt };\r\n\t\t\tlet tr = { x: (w + tw) / 2 + pl, y: pt };\r\n\r\n\t\t\tlet br = { x: (w + bw) / 2 + pl, y: pt + h };\r\n\t\t\tlet bl = { x: (w - bw) / 2 + pl, y: pt + h };\r\n\r\n\t\t\tlet mlx = tl.x + (bl.x - tl.x) * locationY;\r\n\t\t\tlet mrx = tr.x + (br.x - tr.x) * locationY;\r\n\r\n\t\t\treturn { x: mlx + (mrx - mlx) * locationX, y: tr.y + (br.y - tr.y) * locationY };\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet tw = $utils.relativeToValue(this.topWidth, h);\r\n\t\t\tlet bw = $utils.relativeToValue(this.bottomWidth, h);\r\n\r\n\t\t\tlet tt = { x: pl, y: (h - tw) / 2 + pt };\r\n\t\t\tlet tb = { x: pl, y: (h + tw) / 2 + pt };\r\n\r\n\t\t\tlet bt = { x: pl + w, y: (h - bw) / 2 + pt };\r\n\t\t\tlet bb = { x: pl + w, y: (h + bw) / 2 + pt };\r\n\r\n\t\t\tlet mty = tt.y + (bt.y - tt.y) * locationX;\r\n\t\t\tlet mby = tb.y + (bb.y - tb.y) * locationX;\r\n\r\n\t\t\treturn { y: mty + (mby - mty) * locationY, x: tt.x + (bt.x - tt.x) * locationX };\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Bottom width in pixels or percent.\r\n\t *\r\n\t * IMPORTANT: this setting might be used to set dimensions if you use slice\r\n\t * as a standalone element. If it's a part of [[FunnelSeries]] this setting\r\n\t * becomes read-only as it will be automatically reset by series.\r\n\t *\r\n\t * @param value  Bottom width\r\n\t */\r\n\tpublic set bottomWidth(value: number | Percent) {\r\n\t\tthis.setPercentProperty(\"bottomWidth\", value, true, false, 10, false);\r\n\t}\r\n\r\n\t/**\r\n\t * @return bottom width\r\n\t */\r\n\tpublic get bottomWidth(): number | Percent {\r\n\t\treturn this.getPropertyValue(\"bottomWidth\");\r\n\t}\r\n\r\n\t/**\r\n\t * Top width in pixels or percent.\r\n\t *\r\n\t * IMPORTANT: this setting might be used to set dimensions if you use slice\r\n\t * as a standalone element. If it's a part of [[FunnelSeries]] this setting\r\n\t * becomes read-only as it will be automatically reset by series.\r\n\t *\r\n\t * @param value  Top width\r\n\t */\r\n\tpublic set topWidth(value: number | Percent) {\r\n\t\tthis.setPercentProperty(\"topWidth\", value, true, false, 10, false);\r\n\t}\r\n\r\n\t/**\r\n\t * @return Top width\r\n\t */\r\n\tpublic get topWidth(): number | Percent {\r\n\t\treturn this.getPropertyValue(\"topWidth\");\r\n\t}\r\n\r\n\t/**\r\n\t * Orientation of the funnel slice: \"horizontal\" or \"vertical\".\r\n\t *\r\n\t * IMPORTANT: this setting might be used to set orintation if you use slice\r\n\t * as a standalone element. If it's a part of [[FunnelSeries]] this setting\r\n\t * becomes read-only as it will be automatically reset by series.\r\n\t *\r\n\t * @param value  Orientation\r\n\t */\r\n\tpublic set orientation(value: Orientation) {\r\n\t\tthis.setPropertyValue(\"orientation\", value, true);\r\n\t}\r\n\r\n\t/**\r\n\t * @return Orientation\r\n\t */\r\n\tpublic get orientation(): Orientation {\r\n\t\treturn this.getPropertyValue(\"orientation\");\r\n\t}\r\n\r\n\t/**\r\n\t * A relative distance slice's sides should be bent to. It's relative to the\r\n\t * height of the slice.\r\n\t *\r\n\t * Zero (default) will mean the sides will be perfectly straight.\r\n\t *\r\n\t * Positive value will make them bend outwards, resulting in \"puffed\" slices.\r\n\t *\r\n\t * Negative values will make them bend inwards.\r\n\t *\r\n\t * @default 0\r\n\t * @param {number}\r\n\t */\r\n\tpublic set expandDistance(value: number) {\r\n\t\tthis.setPropertyValue(\"expandDistance\", value, true);\r\n\t}\r\n\r\n\t/**\r\n\t * @return expandDistance\r\n\t */\r\n\tpublic get expandDistance(): number {\r\n\t\treturn this.getPropertyValue(\"expandDistance\");\r\n\t}\r\n\r\n\t/**\r\n\t * Copies all parameters from another [[Sprite]].\r\n\t *\r\n\t * @param source Source Sprite\r\n\t */\r\n\tpublic copyFrom(source :this) {\r\n\t\tsuper.copyFrom(source);\r\n\t\tif (this.slice) {\r\n\t\t\tthis.slice.copyFrom(source.slice);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Register class in system, so that it can be instantiated using its name from\r\n * anywhere.\r\n *\r\n * @ignore\r\n */\r\nregistry.registeredClasses[\"FunnelSlice\"] = FunnelSlice;\r\n"]},"metadata":{},"sourceType":"module"}